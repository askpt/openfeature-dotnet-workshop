@using Garage.Shared.Models
@inject ILogger<CarCard> Logger
@rendermode InteractiveServer 

<div class="car-card">
    <div class="car-header">
        <span class="car-year">@Car.Year</span>
        <div class="car-actions">
            <input type="checkbox" class="ownership-checkbox" checked="@Car.IsOwned" @onchange="ToggleOwnership" />
        </div>
    </div>
    <h3>@Car.Model</h3>
    <span class="car-class">@Car.Class</span>
    <div class="car-image-placeholder">
        <span>No Image Available</span>
    </div>
    <div class="car-details">
        <div class="detail-row">
            <span class="detail-icon">ğŸ”§</span>
            <span>Engine: @Car.Engine</span>
        </div>
        <div class="detail-row">
            <span class="detail-icon">ğŸ</span>
            <span>Drivers:</span>
        </div>
        <div class="drivers">@string.Join(", ", Car.Drivers)</div>
    </div>
</div>

@code {
    [Parameter, EditorRequired]
    public required Winner Car { get; set; }
    
    [Parameter]
    public EventCallback<Winner> OnOwnershipChanged { get; set; }
    
    private async Task ToggleOwnership(ChangeEventArgs e)
    {
        if (e.Value is bool value)
        {
            Logger.LogDebug("Toggling ownership for car {Year}", Car.Year);
            Car.IsOwned = value;
            await OnOwnershipChanged.InvokeAsync(Car);
        }
    }
}
